<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Kanban + Notes + Pomodoro + IST Clock</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
    /* ===== Your original Kanban styles (kept as-is) ===== */
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background-color: #1e1e1e;
        color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    h1 {
        margin-top: 20px;
        text-align: center;
    }
    .board {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 20px;
        width: 90%;
    }
    .column {
        background-color: #2e2e2e;
        flex: 1;
        padding: 10px;
        border-radius: 10px;
        min-height: 400px;
        display: flex;
        flex-direction: column;
    }
    .column h2 {
        text-align: center;
    }
    .task {
        background-color: #444;
        padding: 10px;
        margin: 5px 0;
        border-radius: 5px;
        cursor: grab;
    }
    .task:active {
        cursor: grabbing;
    }
    .add-task {
        display: flex;
        margin-top: 10px;
        gap: 5px;
        width: 90%;
        max-width: 900px;
    }
    .add-task input {
        flex: 1;
        padding: 8px 10px;
        border-radius: 6px;
        border: none;
        outline: none;
        background:#3a3a3a; color:#fff;
    }
    .add-task button {
        padding: 8px 14px;
        background-color: #4cafef;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 700;
    }
    #dustbin {
        background-color: #8b0000; /* Red for delete */
    }
    .footer {
        margin: 20px;
        text-align: center;
        font-weight: bold;
        font-family: 'Courier New', monospace;
    }

    /* ===== Bottom row layout (Notes | Timer | Clock) ===== */
    .bottom {
        width: 90%;
        display: grid;
        gap: 20px;
        grid-template-columns: 1.1fr 1fr 1fr;
        margin: 24px 0 30px;
    }
    @media (max-width: 1100px) {
        .bottom { grid-template-columns: 1fr; }
    }

    .panel {
        background:#2a2a2a;
        border:1px solid rgba(255,255,255,0.08);
        border-radius: 12px;
        padding: 14px;
    }
    .panel h2 {
        margin: 0 0 10px;
        font-size: 18px;
        text-align: left;
    }

    /* Notes */
    #notesArea {
        width: 100%;
        height: 260px;
        background:#1f1f1f;
        color:#fff;
        border:1px solid rgba(255,255,255,0.08);
        border-radius:10px;
        padding:10px;
        outline:none;
        resize:vertical;
    }
    .hint { color:#cfcfcf; font-size:12px; margin-top:8px; opacity:.8 }

    /* Pomodoro Timer */
    .timer-display {
        display:flex; align-items:flex-end; justify-content:center; gap:10px; margin:8px 0 14px;
    }
    #countdown {
        font-size: 46px; /* a little big as requested */
        font-weight: 800;
        letter-spacing: 1px;
    }
    #phase {
        font-size: 14px;
        background:#3b3b3b;
        padding: 4px 10px;
        border-radius: 999px;
        border:1px solid rgba(255,255,255,0.09);
        color:#eaeaea;
    }
    .timer-controls {
        display:flex; gap:10px; justify-content:center;
    }
    .btn {
        border:none; border-radius:8px; padding:8px 12px; cursor:pointer; font-weight:700;
    }
    .btn.start { background:#4cafef; color:#111; }
    .btn.reset { background:#e74c3c; color:#fff; }
    .timer-inputs {
        display:flex; gap:10px; justify-content:center; margin-bottom:10px;
    }
    .timer-inputs input {
        width:80px; padding:8px; border-radius:8px; border:1px solid rgba(255,255,255,0.08);
        background:#1f1f1f; color:#fff; text-align:center; font-weight:700;
    }

    /* Analog Clock (IST) ‚Äì simple, clean, dark */
    .clock-wrap { display:flex; flex-direction:column; align-items:center; }
    #clockCanvas {
        width: 100%;
        max-width: 280px;
        aspect-ratio: 1 / 1;
        background:#1f1f1f;
        border-radius: 999px;
        border: 1px solid rgba(255,255,255,0.08);
        display:block;
    }
    #digitalIST {
        margin-top:8px; font-size:12px; color:#cfcfcf;
    }
</style>
</head>
<body>

<h1>Kanban Board</h1>

<div class="add-task">
    <input type="text" id="taskInput" placeholder="Enter new task">
    <button onclick="addTask()">Add</button>
</div>

<div class="board">
    <div class="column" id="todo" ondrop="drop(event)" ondragover="allowDrop(event)">
        <h2>To Do</h2>
    </div>
    <div class="column" id="inprogress" ondrop="drop(event)" ondragover="allowDrop(event)">
        <h2>In Progress</h2>
    </div>
    <div class="column" id="dustbin" ondrop="dropToDustbin(event)" ondragover="allowDrop(event)">
        <h2>üóëÔ∏è Dustbin</h2>
    </div>
</div>

<!-- Bottom row: Notes | Timer | Clock -->
<div class="bottom">
    <!-- Notes -->
    <div class="panel">
        <h2>Notes</h2>
        <textarea id="notesArea" placeholder="Write your notes here..."></textarea>
        <div class="hint">Notes are auto-saved to your browser.</div>
    </div>

    <!-- Timer -->
    <div class="panel">
        <h2>Pomodoro Timer</h2>
        <div class="timer-inputs">
            <label>Work (min): <input id="workMinutes" type="number" min="1" value="25"></label>
            <label>Break (min): <input id="breakMinutes" type="number" min="1" value="5"></label>
        </div>
        <div class="timer-display">
            <div id="countdown">25:00</div>
            <div id="phase">Work</div>
        </div>
        <div class="timer-controls">
            <button class="btn start" id="startBtn">Start</button>
            <button class="btn reset" id="resetBtn">Reset</button>
        </div>
        <div class="hint" id="timerHint">Starts only when you press <b>Start</b>. Auto: 25 ‚Üí 5 ‚Üí Stop.</div>
    </div>

    <!-- Clock -->
    <div class="panel clock-wrap">
        <h2>IST Analog Clock</h2>
        <canvas id="clockCanvas" width="300" height="300"></canvas>
        <div id="digitalIST"></div>
    </div>
</div>

<div class="footer">Created by <b>Sadik Pathan</b></div>

<script>
/* =========================
   Your original Kanban JS (kept)
========================= */
let taskId = 0;

function saveBoard() {
    const columns = ["todo", "inprogress"];
    let boardData = {};
    columns.forEach(col => {
        let tasks = [];
        document.querySelectorAll(`#${col} .task`).forEach(task => {
            tasks.push(task.innerText);
        });
        boardData[col] = tasks;
    });
    localStorage.setItem("kanbanBoard", JSON.stringify(boardData));
}

function loadBoard() {
    let boardData = JSON.parse(localStorage.getItem("kanbanBoard"));
    if (!boardData) return;
    Object.keys(boardData).forEach(col => {
        boardData[col].forEach(taskText => {
            let task = createTask(taskText);
            document.getElementById(col).appendChild(task);
        });
    });
}

function createTask(text) {
    let task = document.createElement("div");
    task.className = "task";
    task.draggable = true;
    task.id = "task" + taskId++;
    task.innerText = text;
    task.ondragstart = drag;
    return task;
}

function addTask() {
    let taskText = document.getElementById("taskInput").value.trim();
    if (taskText === "") return;
    let task = createTask(taskText);
    document.getElementById("todo").appendChild(task);
    document.getElementById("taskInput").value = "";
    saveBoard();
}

function allowDrop(ev) {
    ev.preventDefault();
}

function drag(ev) {
    ev.dataTransfer.setData("text", ev.target.id);
}

function drop(ev) {
    ev.preventDefault();
    let data = ev.dataTransfer.getData("text");
    ev.target.closest(".column").appendChild(document.getElementById(data));
    saveBoard();
}

function dropToDustbin(ev) {
    ev.preventDefault();
    let data = ev.dataTransfer.getData("text");
    let task = document.getElementById(data);
    if (task) {
        task.remove(); // delete task
        saveBoard(); // update storage without this task
    }
}

window.onload = loadBoard;

/* =========================
   Notes (localStorage)
========================= */
const NOTES_KEY = 'notes_v1';
const notesArea = document.getElementById('notesArea');
notesArea.value = localStorage.getItem(NOTES_KEY) || '';
notesArea.addEventListener('input', () => {
    localStorage.setItem(NOTES_KEY, notesArea.value);
});

/* =========================
   Pomodoro Timer
   Flow: Start ‚Üí 25 work ‚Üí auto 5 break ‚Üí Stop
   Persists state to localStorage
========================= */
const TIMER_KEY = 'pomodoro_v1';
const countdownEl = document.getElementById('countdown');
const phaseEl = document.getElementById('phase');
const startBtn = document.getElementById('startBtn');
const resetBtn = document.getElementById('resetBtn');
const workInput = document.getElementById('workMinutes');
const breakInput = document.getElementById('breakMinutes');
const timerHint = document.getElementById('timerHint');

const defaultTimer = {
  phase:'work', // 'work'|'break'
  workMinutes:25,
  breakMinutes:5,
  remainingSec:25*60,
  running:false,
  lastTick:null
};
let timerState = { ...defaultTimer, ...JSON.parse(localStorage.getItem(TIMER_KEY) || '{}') };

workInput.value = timerState.workMinutes;
breakInput.value = timerState.breakMinutes;
updateCountdownLabel();
phaseEl.textContent = timerState.phase === 'work' ? 'Work' : 'Break';

function saveTimer(){ localStorage.setItem(TIMER_KEY, JSON.stringify(timerState)); }
function formatMMSS(sec){ const m = Math.floor(sec/60), s = sec%60; return String(m).padStart(2,'0')+':'+String(s).padStart(2,'0'); }
function updateCountdownLabel(){ countdownEl.textContent = formatMMSS(timerState.remainingSec); }

function computeCatchup(){
  if(timerState.running && timerState.lastTick){
    const now = Date.now();
    const elapsed = Math.floor((now - timerState.lastTick)/1000);
    if(elapsed>0){
      timerState.remainingSec = Math.max(0, timerState.remainingSec - elapsed);
      timerState.lastTick = now;
      saveTimer();
    }
  }
}

let tickHandle = null;
function tickLoop(){
  clearInterval(tickHandle);
  tickHandle = setInterval(()=>{
    computeCatchup();
    if(timerState.remainingSec <= 0){
      if(timerState.phase === 'work'){
        // Auto switch to break
        timerState.phase = 'break';
        timerState.remainingSec = Math.max(1, parseInt(breakInput.value||timerState.breakMinutes))*60;
        phaseEl.textContent = 'Break';
        timerState.lastTick = Date.now();
        saveTimer();
      } else {
        // Break finished -> Stop
        timerState.running = false;
        timerState.lastTick = null;
        saveTimer();
        clearInterval(tickHandle);
        timerHint.textContent = 'Cycle complete. Press Start to begin again.';
      }
    }
    updateCountdownLabel();
  }, 500);
}

function startTimer(){
  if(timerState.running) return;
  // Take current inputs
  timerState.workMinutes = Math.max(1, parseInt(workInput.value||'25'));
  timerState.breakMinutes = Math.max(1, parseInt(breakInput.value||'5'));
  // If stopped at end or freshly reset, ensure correct phase duration
  if(timerState.remainingSec <= 0 || timerState.remainingSec > 60*1800){
    timerState.phase = 'work';
    timerState.remainingSec = timerState.workMinutes * 60;
    phaseEl.textContent = 'Work';
  }
  timerState.running = true;
  timerState.lastTick = Date.now();
  saveTimer();
  tickLoop();
  timerHint.textContent = 'Running‚Ä¶';
}

function resetTimer(){
  clearInterval(tickHandle);
  timerState.phase = 'work';
  timerState.workMinutes = Math.max(1, parseInt(workInput.value||'25'));
  timerState.breakMinutes = Math.max(1, parseInt(breakInput.value||'5'));
  timerState.remainingSec = timerState.workMinutes * 60;
  timerState.running = false;
  timerState.lastTick = null;
  saveTimer();
  phaseEl.textContent = 'Work';
  updateCountdownLabel();
  timerHint.textContent = 'Reset. Press Start to begin.';
}

startBtn.addEventListener('click', startTimer);
resetBtn.addEventListener('click', resetTimer);

// If it was running before refresh, resume
(function initTimer(){
  computeCatchup();
  updateCountdownLabel();
  if(timerState.running){ tickLoop(); timerHint.textContent='Running‚Ä¶'; }
})();

/* =========================
   Simple Clean IST Analog Clock (dark)
========================= */
const canvas = document.getElementById('clockCanvas');
const ctx = canvas.getContext('2d');
let r = canvas.width/2;
ctx.translate(r, r);

function drawClock(){
  ctx.clearRect(-r,-r, canvas.width, canvas.height);

  // Face
  ctx.beginPath();
  ctx.arc(0,0, r-2, 0, Math.PI*2);
  ctx.fillStyle = '#1b1b1b';
  ctx.fill();
  ctx.lineWidth = 6;
  ctx.strokeStyle = 'rgba(255,255,255,0.08)';
  ctx.stroke();

  // Hour ticks
  ctx.lineWidth = 3; ctx.strokeStyle='rgba(255,255,255,0.6)';
  for(let i=0;i<12;i++){
    const ang = i*Math.PI/6;
    ctx.save();
    ctx.rotate(ang);
    ctx.beginPath();
    ctx.moveTo(0, -(r-12)); ctx.lineTo(0, -(r-24));
    ctx.stroke();
    ctx.restore();
  }
  // Minute ticks
  ctx.lineWidth = 1; ctx.strokeStyle='rgba(255,255,255,0.25)';
  for(let i=0;i<60;i++){
    if(i%5===0) continue;
    const ang = i*Math.PI/30;
    ctx.save();
    ctx.rotate(ang);
    ctx.beginPath();
    ctx.moveTo(0, -(r-16)); ctx.lineTo(0, -(r-22));
    ctx.stroke();
    ctx.restore();
  }

  // Time (IST)
  const now = new Date();
  const parts = new Intl.DateTimeFormat('en-US', { hour:'numeric', minute:'numeric', second:'numeric', hour12:false, timeZone:'Asia/Kolkata'}).formatToParts(now);
  let h = parseInt(parts.find(p=>p.type==='hour').value,10);
  let m = parseInt(parts.find(p=>p.type==='minute').value,10);
  let s = parseInt(parts.find(p=>p.type==='second').value,10);

  // Hands
  drawHand(((h%12)*Math.PI/6) + (m*Math.PI/(6*60)) + (s*Math.PI/(360*60)), r*0.52, 5, '#ffffff'); // hour
  drawHand((m*Math.PI/30) + (s*Math.PI/(30*60)), r*0.74, 3, '#b0c4ff'); // minute
  drawHand((s*Math.PI/30), r*0.80, 1.5, '#67d4a1'); // second

  // Center
  ctx.beginPath(); ctx.arc(0,0,3.5,0,Math.PI*2); ctx.fillStyle='#ffffff'; ctx.fill();

  // Digital under clock
  const digital = new Intl.DateTimeFormat('en-US', { hour:'numeric', minute:'2-digit', second:'2-digit', hour12:true, timeZone:'Asia/Kolkata'}).format(now);
  document.getElementById('digitalIST').textContent = digital + ' (IST)';
}
function drawHand(angle, length, width, color){
  ctx.save();
  ctx.rotate(angle);
  ctx.beginPath();
  ctx.strokeStyle = color; ctx.lineWidth = width; ctx.lineCap='round';
  ctx.moveTo(0, 8); // tail
  ctx.lineTo(0, -length);
  ctx.stroke();
  ctx.restore();
}
setInterval(drawClock, 1000);
drawClock();

// Responsive canvas crispness
function resizeClock(){
  const max = Math.min(280, document.querySelector('.clock-wrap').clientWidth - 20);
  const size = Math.max(180, max);
  canvas.width = size; canvas.height = size;
  r = size/2; ctx.setTransform(1,0,0,1,0,0); ctx.translate(r,r);
  drawClock();
}
window.addEventListener('resize', resizeClock);
resizeClock();
</script>

</body>
</html>
