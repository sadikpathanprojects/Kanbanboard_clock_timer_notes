<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Kanban Board + Continuous Panel</title>
<style>
:root{
  --bg:#1e1e1e; --col:#2e2e2e; --task:#444; --accent:#4cafef; --danger:#8b0000;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Arial, Helvetica, sans-serif;
  background:var(--bg);
  color:#fff;
  display:flex;
  flex-direction:column;
  align-items:center;
  min-height:100vh;
}
h1{margin:18px 0 6px;text-align:center}
.add-task{
  width:90%;
  display:flex;
  gap:8px;
  margin-bottom:14px;
}
.add-task input{
  flex:1;padding:8px;border-radius:6px;border:0;outline:none;
}
.add-task button{
  padding:8px 12px;border-radius:6px;border:0;background:var(--accent);color:#fff;cursor:pointer;
}
.board{
  width:95%;
  display:flex;
  gap:18px;
  justify-content:center;
  align-items:flex-start;
}
.column{
  background:var(--col);
  border-radius:10px;
  padding:10px;
  flex:1;
  min-height:420px;
  display:flex;
  flex-direction:column;
}
.column h2{text-align:center;margin:6px 0 10px}
.task{
  background:var(--task);
  padding:8px;
  margin:6px 0;
  border-radius:6px;
  display:flex;
  align-items:center;
  gap:8px;
  user-select:text;
}
.drag-handle{
  cursor:grab;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:6px;
  border-radius:6px;
  font-size:16px;
  user-select:none;
}
.drag-handle:active{cursor:grabbing}
.task-text{
  flex:1;
  word-break:break-word;
  padding-right:6px;
}
#dustbin{background:var(--danger)}
.footer{
  margin:20px;font-weight:bold;font-family:'Courier New',monospace;
}
/* toast */
.toast{
  position:fixed;
  left:50%;
  transform:translateX(-50%);
  bottom:28px;
  background:#222;
  color:#fff;
  padding:8px 14px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,.5);
  opacity:0;pointer-events:none;transition:opacity .18s ease;
}
.toast.show{opacity:1;pointer-events:auto}
@media (max-width:600px){
  .board{flex-direction:column}
}
/* Bottom panel */
.bottom-panel{
  width:95%;
  display:grid;
  grid-template-columns:1.5fr 0.5fr;
  gap:18px;
  margin:24px 0;
}
.bottom-panel textarea{
  flex:1; background:#1f1f1f; border-radius:8px; border:none; color:#fff; padding:8px; resize:vertical;
}
.bottom-panel h3{
  margin:0 0 10px;
}
.bottom-panel button{
  border:none; border-radius:6px; cursor:pointer;
}
#startTimerBtn{background:#4cafef; color:#111; padding:6px 12px; margin-top:10px;}
#resetTimerBtn{background:#e74c3c; color:#fff; padding:6px 12px; margin-top:6px;}
</style>
</head>
<body>

<h1>Kanban Board</h1>

<div class="add-task">
  <input id="taskInput" placeholder="Enter new task" />
  <button onclick="addTask()">Add</button>
</div>

<div class="board">
  <div class="column" id="todo" ondrop="drop(event)" ondragover="allowDrop(event)">
    <h2>To Do</h2>
  </div>

  <div class="column" id="inprogress" ondrop="drop(event)" ondragover="allowDrop(event)">
    <h2>In Progress</h2>
  </div>
  
  <div class="column" id="onhold" ondrop="drop(event)" ondragover="allowDrop(event)">
    <h2>‚è∏ On Hold</h2>
  </div>

  

  <div class="column" id="completed" ondrop="drop(event)" ondragover="allowDrop(event)">
    <h2>‚úÖ Completed</h2>
  </div>

  <div class="column" id="dustbin" ondrop="dropToDustbin(event)" ondragover="allowDrop(event)">
    <h2>üóëÔ∏è Dustbin</h2>
  </div>
</div>

<!-- Bottom continuous panel -->
<div class="bottom-panel">
  <!-- Notes -->
  <div style="background:#2e2e2e; border-radius:10px; padding:12px; display:flex; flex-direction:column;">
    <h3>Notes</h3>
    <textarea id="continuousNotes" placeholder="Write your notes here‚Ä¶"></textarea>
    <small style="opacity:0.7; margin-top:6px;">Notes auto-saved in browser</small>
  </div>

  <!-- Pomodoro Timer -->
  

  <!-- IST Clock -->
  <div style="background:#2e2e2e; border-radius:10px; padding:12px; display:flex; flex-direction:column; align-items:center;">
    <h3>IST Clock</h3>
    <canvas id="bottomClock" width="180" height="180" style="border-radius:50%; background:#1f1f1f;"></canvas>
    <div id="bottomDigital" style="margin-top:6px; font-size:12px; opacity:0.7;"></div>
  </div>
</div>

<div class="footer">Created by <b>Sadik Pathan</b></div>
<div id="toast" class="toast" aria-live="polite"></div>

<script>
let taskId = 0;

// ===== Kanban functions =====
function saveBoard(){
  const columns = ["todo","onhold","inprogress","completed"];
  const boardData = {};
  columns.forEach(col => {
    const list = [];
    document.querySelectorAll(`#${col} .task`).forEach(t => {
      const txt = t.querySelector(".task-text")?.innerText ?? "";
      list.push(txt);
    });
    boardData[col] = list;
  });
  localStorage.setItem("kanbanBoard", JSON.stringify(boardData));
}

function loadBoard(){
  const boardData = JSON.parse(localStorage.getItem("kanbanBoard") || "null");
  if(!boardData) return;
  Object.keys(boardData).forEach(col => {
    boardData[col]?.forEach(taskText => {
      const task = createTask(taskText);
      document.getElementById(col).appendChild(task);
    });
  });
}

function createTask(text){
  const task = document.createElement("div");
  task.className = "task";
  task.id = "task" + (taskId++);

  // drag handle
  const handle = document.createElement("span");
  handle.className = "drag-handle";
  handle.title = "Drag to move";
  handle.innerText = "‚ò∞";
  handle.draggable = true;
  handle.addEventListener("dragstart", function(ev){
    ev.dataTransfer.setData("text/plain", task.id);
  });

  // editable text
  const span = document.createElement("span");
  span.className = "task-text";
  span.innerText = text;
  span.contentEditable = true; // make it editable
  span.addEventListener("blur", saveBoard); // save when you leave the text
  span.addEventListener("keydown", (e)=>{
    if(e.key === "Enter"){
      e.preventDefault();
      span.blur(); // triggers saveBoard
    }
  });

  // assemble task
  task.appendChild(handle);
  task.appendChild(span);

  return task;
}
  

function addTask(){
  const input = document.getElementById("taskInput");
  const text = input.value.trim();
  if(!text) return;
  const task = createTask(text);
  document.getElementById("todo").appendChild(task);
  input.value = "";
  saveBoard();
}

function allowDrop(ev){ ev.preventDefault(); }
function drop(ev){
  ev.preventDefault();
  const id = ev.dataTransfer.getData("text/plain");
  const task = document.getElementById(id);
  const col = ev.target.closest(".column");
  if(!col || !task) return;
  col.appendChild(task);
  saveBoard();
}
function dropToDustbin(ev){
  ev.preventDefault();
  const id = ev.dataTransfer.getData("text/plain");
  const task = document.getElementById(id);
  if(task){ task.remove(); saveBoard(); showToast("Task deleted"); }
}

// ===== Toast =====
let toastTimer = null;
function showToast(msg, timeout=1200){
  const t = document.getElementById("toast");
  t.textContent = msg;
  t.classList.add("show");
  if(toastTimer) clearTimeout(toastTimer);
  toastTimer = setTimeout(()=> t.classList.remove("show"), timeout);
}

window.addEventListener("load", loadBoard);

// ===== Notes auto-save =====
const NOTES_KEY = "continuousNotes";
const notesArea = document.getElementById("continuousNotes");
notesArea.value = localStorage.getItem(NOTES_KEY) || "";
notesArea.addEventListener("input", ()=> localStorage.setItem(NOTES_KEY, notesArea.value));

// ===== Pomodoro Timer =====

function formatTime(sec){
  const m = Math.floor(sec/60), s=sec%60;
  return String(m).padStart(2,'0')+":"+String(s).padStart(2,'0');
}


// ===== IST Clock =====
const canvas = document.getElementById("bottomClock");
const ctx = canvas.getContext("2d");
let r = canvas.width/2;
ctx.translate(r,r);

function drawClock(){
  ctx.clearRect(-r,-r, canvas.width, canvas.height);

  // Face
  ctx.beginPath(); ctx.arc(0,0,r-2,0,Math.PI*2); ctx.fillStyle="#1b1b1b"; ctx.fill();
  ctx.lineWidth=4; ctx.strokeStyle="rgba(255,255,255,0.08)"; ctx.stroke();

  const now = new Date();
  const parts = new Intl.DateTimeFormat('en-US',{hour:'numeric',minute:'numeric',second:'numeric',hour12:false,timeZone:'Asia/Kolkata'}).formatToParts(now);
  const h=parseInt(parts.find(p=>p.type==='hour').value,10);
  const m=parseInt(parts.find(p=>p.type==='minute').value,10);
  const s=parseInt(parts.find(p=>p.type==='second').value,10);

  drawHand(((h%12)*Math.PI/6)+(m*Math.PI/(6*60))+(s*Math.PI/(360*60)), r*0.5, 4, "#fff");
  drawHand((m*Math.PI/30)+(s*Math.PI/(30*60)), r*0.7, 3, "#4cafef");
  drawHand((s*Math.PI/30), r*0.75, 1.5, "#67d4a1");

  ctx.beginPath(); ctx.arc(0,0,3,0,Math.PI*2); ctx.fillStyle="#fff"; ctx.fill();

  // Digital
  const digital = new Intl.DateTimeFormat('en-US',{hour:'numeric',minute:'2-digit',second:'2-digit',hour12:true,timeZone:'Asia/Kolkata'}).format(now);
  document.getElementById("bottomDigital").textContent = digital+" (IST)";
}

function drawHand(angle,length,width,color){
  ctx.save();
  ctx.rotate(angle);
  ctx.beginPath();
  ctx.strokeStyle=color; ctx.lineWidth=width; ctx.lineCap='round';
  ctx.moveTo(0,8);
  ctx.lineTo(0,-length);
  ctx.stroke();
  ctx.restore();
}
setInterval(drawClock,1000);
drawClock();
</script>

</body>
</html>
